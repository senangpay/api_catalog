---
icon: diamond-half-stroke
---

# 3D Get Token

## **Why 3D?**

3D authentication provides a more secure way of authenticating the ownership of the card holders. When requesting a payment token, card holder need to enter the OTP (one time password) to prove that they are the owner of the card. This will block any use of unauthorized cards for senangPay tokenization.

## **How does it work?**

**This is not a RESTful API.** The flow of the new Get Token method consists of multiple web views. You can either have an HTML form that will send the required parameters OR you can send as query string parameters (GET). If you are implementing tokenization on a mobile app, you need to implement it in a web view/iframe. We wish to convey our apologies because, at the moment, we are not providing any SDK.

## **Will senangPay charge card holders for card validation?**

senangPay may make two transactions of RM1 on the card, to prove that the card is valid and can perform both 3D and 2D transactions. **Both transactions will be reversed back to the card.** However, it may take several days for the bank to reverse the money back to the card.

&#x20;

***

## **Tokenization Return URL & Callback URL**

Before anything else, you need to provide the Tokenization Return URL and Callback URL. Tokenization Return URL is the URL where senangPay will redirect the card holders to after the payment (card validation) has been processed. This will the the page where the user will see or landed after card validation.

1\. While Tokenization Callback URL is the URL to your backend, where senangPay will send notifications about the card validation status.

2\. You need to provide the URLs at Your senangPay **Dashboard > Settings > Profile > Shopping Cart Integration Link**&#x20;

3\. Fill in the **Tokenization Return URL** and **Tokenization Callback URL** field.



***



## **Integration Method**

**1. 3D Get token (This is not REST)**

<table data-header-hidden data-full-width="false"><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Production URL Endpoint (GET/POST)</td><td>https://app.senangpay.my/tokenization/{merchant_id}</td></tr><tr><td>Sandbox URL Endpoint (GET/POST)</td><td>https://sandbox.senangpay.my/tokenization/{merchant_id}</td></tr></tbody></table>

&#x20;

**2. Request Parameter (All Mandatory)**

<table><thead><tr><th width="233">Item</th><th>Details</th></tr></thead><tbody><tr><td><strong>order_id</strong></td><td>Used by your system to track the request and response. It can be any value.</td></tr><tr><td><strong>name</strong></td><td><p>Your customer’s name. Maximum length is 100.</p><ul><li>Example : Micheal Solomon</li></ul></td></tr><tr><td><strong>email</strong></td><td><p>Your customer’s email.</p><ul><li>Example : micheal@theboringcompany.com</li></ul></td></tr><tr><td><strong>phone</strong></td><td><p>Your customer’s phone number. </p><ul><li>Example : +60123456789</li></ul></td></tr><tr><td><strong>hash</strong></td><td><p>This hash confirms you are an active senangPay merchant. Generate it using HMAC SHA256 with your senangPay secret key.</p><p>Here’s a simple PHP example:</p><pre class="language-php"><code class="lang-php">$merchant_id = '123456789';
$secret_key = '34-9887';
$order_id = 'abc654321'; // Your order ID
$string_to_hash = $merchant_id . $order_id;
$final_hash = hash_hmac('SHA256', $string_to_hash, $secret_key);
</code></pre><p>For example, hashing <code>54316046480557456</code> would produce:</p><p><code>151bf4a479ed166d6b211528d0a0b452625c8fe83</code></p></td></tr></tbody></table>



**3. Respond Parameter**

<table><thead><tr><th width="221">Item</th><th>Details</th></tr></thead><tbody><tr><td><strong><code>status</code></strong></td><td><p>Token creation status.</p><ul><li><code>1</code> if successful.</li><li><code>0</code> if failed.</li></ul></td></tr><tr><td><strong><code>order_id</code></strong></td><td>The order id provided earlier.</td></tr><tr><td><strong><code>token</code></strong></td><td>Generated if card validation succeeds, used for future payments. If validation fails, the token value is <code>0</code>.</td></tr><tr><td><strong><code>cc_num</code></strong></td><td>Last four digits of the card, displayed as <code>XXXXXXXXXXXX1118</code>. If validation fails, the value is <code>0000</code>.</td></tr><tr><td><strong><code>cc_type</code></strong></td><td>Indicates the card type, either <code>vs</code> for Visa or <code>mc</code> for Mastercard. If validation fails, the value is <code>xx</code>.</td></tr><tr><td><strong><code>msg</code></strong></td><td>Card validation status message. Provides different messages Card validation status message, detailing success or failure reasons.</td></tr><tr><td><strong><code>hash</code></strong></td><td><p>Generated by senangPay to verify the response. Use HMAC SHA256 with your secret key to validate it.</p><p>Here’s a PHP example:</p><pre class="language-php"><code class="lang-php">$secret_key = '34-9887';
$order_id = urldecode($_GET['order_id']);
$status_id = urldecode($_GET['status_id']);
$token = urldecode($_GET['token']);
$cc_num = urldecode($_GET['cc_num']);
$cc_type = urldecode($_GET['cc_type']);
$msg = urldecode($_GET['msg']);
$string_to_hash = $merchant_id . $order_id . $status_id . $token . $cc_num . $cc_type . $msg;
$hash = hash_hmac('sha256', $string_to_hash, $secret_key);
</code></pre><p>$hash = hash_hmac(‘sha256’,$string_to_hash,$secret_key);<br>?></p></td></tr></tbody></table>

&#x20;

{% swagger src="../../.gitbook/assets/swagger phase 1- v5.yaml" path="/tokenization/{merchantID}" method="get" %}
[swagger phase 1- v5.yaml](<../../.gitbook/assets/swagger phase 1- v5.yaml>)
{% endswagger %}



**4. Callback**

The callback URL is used as an alternative notification to merchant backend in case there is a breakdown in transaction flow. This is optional so you can opt not to use this feature. However, this feature is recommended to ensure data integrity between a merchant’s system and senangPay.

The callback process will send the same parameters as what is being sent to the return URL. The callback URL must print out a simple ‘OK’ without any HTML tags. The OK response is needed in order for the callback function to know if it has successfully sent the callback data.

senangPay will fire the callback one minute after the validation is done.

